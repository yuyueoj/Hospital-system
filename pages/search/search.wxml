<!--pages/search/search.wxml-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input-wrapper">
      <input 
        class="search-input" 
        type="text" 
        placeholder="æœç´¢åŒ»ç”Ÿã€ç§‘å®¤æˆ–åŒ»é™¢" 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearchConfirm"
        confirm-type="search"
        focus="{{searchFocus}}"
      />
      <view class="search-icon" bindtap="performSearch">ğŸ”</view>
    </view>
    <button class="search-button" bindtap="performSearch">æœç´¢</button>
  </view>

  <!-- æœç´¢å»ºè®® -->
  <view class="search-suggestions" wx:if="{{showSuggestions && suggestions.length > 0}}">
    <view class="suggestions-title">æœç´¢å»ºè®®</view>
    <view class="suggestions-list">
      <view 
        class="suggestion-item" 
        wx:for="{{suggestions}}" 
        wx:key="{{index}}"
        bindtap="selectSuggestion"
        data-keyword="{{item}}"
      >
        <text class="suggestion-text">{{item}}</text>
        <text class="suggestion-icon">ğŸ”</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢å†å² -->
  <view class="search-history" wx:if="{{!showSuggestions && searchHistory.length > 0 && !searchResults.length}}">
    <view class="history-header">
      <text class="history-title">æœç´¢å†å²</text>
      <button class="clear-history" bindtap="clearHistory">æ¸…ç©º</button>
    </view>
    <view class="history-list">
      <view 
        class="history-item" 
        wx:for="{{searchHistory}}" 
        wx:key="{{index}}"
        bindtap="selectHistory"
        data-keyword="{{item}}"
      >
        <text class="history-text">{{item}}</text>
        <text class="history-icon">â±</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view class="search-results" wx:if="{{searchResults.length > 0}}">
    <view class="results-header">
      <text class="results-title">æœç´¢ç»“æœ ({{searchResults.length}})</text>
    </view>
    <view class="results-list">
      <view 
        class="result-item" 
        wx:for="{{searchResults}}" 
        wx:key="id"
        bindtap="selectDoctor"
        data-doctor-id="{{item.id}}"
      >
        <view class="result-card">
          <view class="doctor-avatar">
            <text class="avatar-text">{{item.name.charAt(0)}}</text>
          </view>
          <view class="doctor-info">
            <view class="doctor-name">{{item.name}}</view>
            <view class="doctor-title">{{item.title}}</view>
            <view class="doctor-location">
              <text class="location-text">{{item.hospitalName}} - {{item.departmentName}}</text>
            </view>
            <view class="doctor-specialty">{{item.specialty}}</view>
          </view>
          <view class="result-arrow">â–¶</view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ— æœç´¢ç»“æœ -->
  <view class="no-results" wx:if="{{searched && searchResults.length === 0}}">
    <view class="no-results-icon">ğŸ”</view>
    <text class="no-results-text">æœªæ‰¾åˆ°ç›¸å…³åŒ»ç”Ÿä¿¡æ¯</text>
    <text class="no-results-tip">è¯·å°è¯•å…¶ä»–å…³é”®è¯</text>
  </view>

  <!-- é»˜è®¤çŠ¶æ€ -->
  <view class="default-state" wx:if="{{!searched && !showSuggestions && searchHistory.length === 0}}">
    <view class="default-icon">ğŸ‘©â€âš•ï¸</view>
    <text class="default-text">è¾“å…¥å…³é”®è¯æœç´¢åŒ»ç”Ÿ</text>
    <text class="default-tip">æ”¯æŒæœç´¢åŒ»ç”Ÿå§“åã€ç§‘å®¤ã€åŒ»é™¢ç­‰</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{searching}}">
    <text>æœç´¢ä¸­...</text>
  </view>
</view>